<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<!--
  ~ 版权所有:杭州火图科技有限公司
  ~ 地址:浙江省杭州市滨江区西兴街道阡陌路智慧E谷B幢4楼在地图中查看
  ~
  ~ (c) Copyright Hangzhou Hot Technology Co., Ltd.
  ~ Floor 4,Block B,Wisdom E Valley,Qianmo Road,Binjiang District
  ~ 2013-2015. All rights reserved.
  ~
  -->

<head lang="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>商品列表</title>
    <link href="../../resources/css/admin.global.css" rel="stylesheet" type="text/css" th:href="@{/resources/css/admin.global.css}"/>
    <link href="../../resources/css/admin.content.css" rel="stylesheet" type="text/css" th:href="@{/resources/css/admin.content.css}"/>
    <link href="../../resources/css/jBox/Skins/Green/jbox.css" rel="stylesheet" type="text/css" th:href="@{/resources/css/jBox/Skins/Green/jbox.css}"/>
    <link href="../../resources/css/jquery-ui-1.10.3.custom.min.css" th:href="@{/resources/css/jquery-ui-1.10.3.custom.min.css}" rel="stylesheet"/>
    <link href="../../resources/css/settlements.css" rel="stylesheet" th:href="@{/resources/css/settlements.css}" type="text/css"/>
    <link href="../../resources/css/shouji.css" rel="stylesheet" th:href="@{/resources/css/shouji.css}" type="text/css" />
    <!--<link href="../resource/3rdParty/searchableSelector/jquery.searchableSelect.css" rel="stylesheet" th:href="@{/resource/3rdParty/searchableSelector/jquery.searchableSelect.css}" type="text/css" />-->
    <script type="text/javascript" src="../../resources/js/jquery/jquery-1.7.2.min.js" th:src="@{/resources/js/jquery/jquery-1.7.2.min.js}"></script>
    <script type="text/javascript" src="../../resources/js/jquery/jquery.utils.js" th:src="@{/resources/js/jquery/jquery.utils.js}"></script>
    <script type="text/javascript" src="../../resources/js/jquery/jquery.jBox-2.3.min.js" th:src="@{/resources/js/jquery/jquery.jBox-2.3.min.js}"></script>
    <script type="text/javascript" src="../../resources/js/hot/admin.js" th:src="@{/resources/js/hot/admin.js}"></script>
    <script src="../../resources/js/jquery/jquery-ui-1.8.20.min.js" th:src="@{/resources/js/jquery/jquery-ui-1.8.20.min.js}"></script>
    <script type="text/javascript" src="../../resources/js/My97DatePicker/WdatePicker.js" th:src="@{/resources/js/My97DatePicker/WdatePicker.js}"></script>
    <!--<script type="text/javascript" src="../resource/3rdParty/searchableSelector/jquery.searchableSelect.js" th:src="@{/resource/3rdParty/searchableSelector/jquery.searchableSelect.js}"></script>-->
    <style type="text/css">
        #bg{
            display: none;
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: 100%;
            background-color: black;
            z-index:1001;
            -moz-opacity: 0.8;
            opacity:.80;
            filter: alpha(opacity=88);
        }
        #loading{
            position:absolute;
            left:45%;
            top:2%;
            padding:2px;
            z-index:20001;
            height:auto;
        }
    </style>

    <script type="text/javascript" th:inline="javascript">
        /*<![CDATA[*/
        $(function(){
            var typeList = /*[[${typeList}]]*/"";
            var brandList = /*[[${brandList}]]*/"";
            var selectedType = /*[[${selectType}]]*/"";
            var selectedBrand = /*[[${selectBrand}]]*/"";
            goodUrl =/*[[@{/good}]]*/"good";
            typeList = eval(typeList);
            brandList = eval(brandList);
            //
            createTidSelect(typeList,'0',selectedType);
            updateBrandSelect(brandList, selectedBrand);
//            $('#parentTidDiv select').searchableSelect();
        })
        function addGood(){
            top.document.getElementById("content_left").contentDocument.getElementById("id_050102").getElementsByTagName("a")[0].click();
        }
        /*]]>*/
        var stId;
    </script>
    <script type="text/javascript" th:inline="javascript">
        /*<![CDATA[*/
        //创建类目下拉菜单
        function createTidSelect (typeLists, grandParentId, selectedType) {
            var i, j;
            var parentId;
            for (i=0; i<typeLists.length;) {
                parentId = typeLists[i]['parentStandardTypeId'];
                var selDiv = document.createElement('div');
                var sel = document.createElement('SELECT');
                sel.setAttribute('name', 'tid_' + parentId);
                sel.setAttribute('id', 'tid_' + parentId);
                var op = document.createElement('OPTION');
                op.setAttribute('value', 0);
                op.innerHTML = '--请选择--';
                sel.appendChild(op);
                //
                if (typeLists[i]['disabled'] == false) {
                    var option = document.createElement('OPTION');
                    option.setAttribute('value', typeLists[i]['standardTypeId']);
                    option.innerHTML = typeLists[i]['name'];
                    option.is_parent = typeLists[i]['parent'];//判断是否是子类目
                    option.parent_id = typeLists[i]['parentStandardTypeId'];
                    sel.appendChild(option);
                }
                for (j=i+1; j<typeLists.length;j++) {
                    if (typeLists[i]['parentStandardTypeId'] != typeLists[j]['parentStandardTypeId']) {   //是否分级，即不是同一级option
                        for (var k = 0; k <= (j-i); k++) { //找到下拉框的selected的option
                            if (sel.options[k].value == typeLists[j]['parentStandardTypeId']) {
                                sel.options[k].selected = true;
                                stId = typeLists[j]['parentStandardTypeId'];
                                break;
                            }
                        }
                        break;
                    }
                    //同一级则继续增加option
                    if (typeLists[j]['disabled'] == false) {
                        var option = document.createElement('OPTION');
                        option.setAttribute('value', typeLists[j]['standardTypeId']);
                        option.innerHTML = typeLists[j]['name'];
                        option.is_parent = typeLists[j]['parent'];//判断是否是子类目
                        option.parent_id = typeLists[j]['parentStandardTypeId'];
                        sel.appendChild(option);
                    }
                }
                if (j == typeLists.length) {   //最后一级，找出selected对应的option
                    for (var k = 0; k <= (j-i); k++) {
                        if (sel.options[k].value == selectedType) {
                            sel.options[k].selected = true;
                            stId = selectedType;
                            break;
                        }
                    }
                }
                i = j;
                selDiv.appendChild(sel);
                selDiv.style.cssText = 'float:left;padding:0px 1px';
                //
                var tidDiv = document.createElement('div');
                if( '0' == parentId ) {
                    document.getElementById('parentTidDiv').appendChild(selDiv);
                    document.getElementById('tid_' + parentId).onchange = function(){childTidList(this);};
                    tidDiv.id = 'tid_' + parentId + '_span';
                    tidDiv.style.cssText = 'float:left;padding:0px 1px';
                    document.getElementById('parentTidDiv').appendChild(tidDiv);
                }
                else {
                    document.getElementById('tid_' + grandParentId + '_span').appendChild(selDiv);
                    document.getElementById('tid_' + parentId).onchange = function(){childTidList(this);};
                    tidDiv.id = 'tid_' + parentId + '_span';
                    tidDiv.style.cssText = 'float:left;padding:0px 1px';
                    document.getElementById('tid_' + grandParentId + '_span').appendChild(tidDiv);
                }
                grandParentId = parentId;
            }
        }
        //品牌下拉表
        function updateBrandSelect(brandList, selectBrand) {
            //var brandDiv = document.getElementById('brandDiv');
            //brandDiv.parentNode().removeChild(brandDiv);
            $("#brandDiv").empty();
            //
            var brandSel = document.createElement('SELECT');
            brandSel.id = "brandIdSelect";
            var brandOp = document.createElement('OPTION');
            brandOp.innerHTML = '--请选择--';
            brandOp.setAttribute('value', 0);
            brandSel.appendChild(brandOp);
            if ('undefined' != brandList) {
                var i;
                var k = 0;
                for (i in brandList) {
                    if (brandList[i]['brandId'] != null) {
                        k++;
                        var option = document.createElement('OPTION');
                        option.innerHTML = brandList[i]['brandName'];
                        option.setAttribute('value', brandList[i]['brandId']);
                        brandSel.appendChild(option);
                        if( selectBrand == brandList[i]['brandId'] )
                            brandSel.options[k].selected = true;
                    }
                }
            }
            //
            var selDiv = document.createElement('div');
            selDiv.style.cssText = 'float:left;padding:0px 1px';
            selDiv.appendChild(brandSel);
//            brandDiv.appendChild(selDiv);
            document.getElementById('brandDiv').appendChild(selDiv);
            //document.getElementById('tid_' + parentId).onchange = function(){childTidList(this, parentId);};
        }
        //子类目监听函数
        function childTidList(o){
            var standardTypeId = o.value;
            stId = standardTypeId;
            var is_parent=o.options[o.selectedIndex].is_parent;
            var parent_id=o.options[o.selectedIndex].parent_id;
            document.getElementById(o.id + '_span').innerHTML = '';
            if( standardTypeId == 0 ) {
                stId = o.options[o.selectedIndex+1].parent_id;
                updateBrandSelect('0','0');
                return;
            }
            if(is_parent){
                updateBrandSelect('0','0');
                $.jBox.tip("正在加载", "loading");
                $.ajax({
                    type:"POST",
                    url: goodUrl + "/getType",
                    data:{
                        standardTypeId:standardTypeId
                    },
                    dataType:"json",
                    success: function (msg) {
                        if(msg.code == 200){
                            var typeList = eval(msg.data);
                            createTidSelect(typeList,parent_id, standardTypeId);
                            $.jBox.closeTip();
                        }else{
                            $.jBox.tip(msg.msg, 'error');
                            window.location.reload();
                        }
                    }
                });
            }else{
                $.jBox.tip("正在加载", "loading");
                $.ajax({
                    type:"POST",
                    url: goodUrl + "/getBrand",
                    data:{
                        standardTypeId:standardTypeId
                    },
                    dataType:"json",
                    success: function (msg) {
                        if(msg.code == 200){
                            var brandList = eval(msg.data);
                            updateBrandSelect(brandList);
                            $.jBox.closeTip();
                        }else{
                            $.jBox.tip(msg.msg, 'error');
                            window.location.reload();
                        }
                    }
                });
            }
        }
        /*]]>*/
    </script>
</head>
<body>
<!--/*-->
<!--@thymesVar id="hbmSupplierGoodsSearcher" type="com.huotu.shopo2o.service.model.HbmSupplierGoodsSearcher"-->
<!--*/-->
<form method="post" action="showGoodsList" id="form1" th:object="${hbmSupplierGoodsSearcher}" >
    <div class="container">
        <div class="blank10">
        </div>
        <div class="search block" style="display: block;">
            <div class="h">
                <span class="icon-sprite icon-magnifier"></span>
                <h3>商品筛选</h3>
            </div>
            <div class="tl corner">
            </div>
            <div class="tr corner">
            </div>
            <div class="bl corner">
            </div>
            <div class="br corner">
            </div>
            <div class="cnt-wp">
                <div class="cnt">
                    <div class="search-bar">
                        <div>
                            <div >
                                <div style="float: left;padding: 3px 0px" >
                                    <label class="first ">商品类目：&nbsp;</label>
                                </div>
                                <div id="parentTidDiv" class="cc-listwrap" style="float: left"/>
                                <input name="standardTypeId" type="text" th:value="*{standardTypeId}" id="standardTypeId" class="input-small" style="width: 120px;display: none" />
                            </div>
                            <br/>
                            <br/>
                            <div >
                                <div style="float: left" >
                                    <label class="first ">商品名称：</label>
                                    <input name="name" type="text" th:value="*{name}" id="name" class="input-small" style="width: 120px;"/>
                                    <label class="first ">店铺分类：</label>
                                    <select id="catId" name="supplierCatId">
                                        <option value="-1" th:selected="*{supplierCatId == -1}">根目录</option>
                                        <option value="0" th:selected="*{supplierCatId == 0}">未分类</option>
                                        <!--/*@thymesVar id="shopCatList" type="java.util.List<com.huotu.shopo2o.service.entity.store.SupShopCat>"*/-->
                                        <th:block th:each="cat:${shopCatList}">
                                            <option th:value="${cat.catId}" th:text="'&nbsp;&nbsp;└ ' + ${cat.catName}" th:selected = "${hbmSupplierGoodsSearcher.supplierCatId == cat.catId}"></option>
                                            <!--最多显示2级-->
                                            <option th:if="${cat.subShopCat!=null}" th:each="subCat:${cat.subShopCat}" th:value="${subCat.catId}"
                                                    th:text="'&nbsp;&nbsp;&nbsp;&nbsp;└ ' + ${subCat.catName}" th:selected = "${hbmSupplierGoodsSearcher.supplierCatId == subCat.catId}" />
                                        </th:block>
                                    </select>
                                    <label class="first ">&nbsp;商品品牌：</label>
                                </div>
                                <div id="brandDiv" class="cc-listwrap" style="float: left"/>
                                <input name="brandId" type="text" th:value="*{brandId}" id="brandId" class="input-small" style="width: 120px;display: none" />
                            </div>

                            <br/>
                            <br/>
                            <label class="first ">商品编号：</label>
                            <input name="bn" type="text" th:value="*{bn}" id="bn" class="input-small" style="width: 120px;"/>
                            <label class="first">&nbsp;状态：
                                <select id="status" name="status">
                                    <option selected="selected" value="-1" th:selected="*{status == -1}">--请选择--</option>
                                    <!--/*@thymesVar id="checkStatusEnums" type="com.huotu.shopo2o.service.enums.CheckStatusEnum"*/-->
                                    <option th:each="checkStatus:${checkStatusEnums}" th:value="${checkStatus.code}" th:text="${checkStatus.value}" th:selected="${checkStatus.code == hbmSupplierGoodsSearcher.status}">未提交审核</option>
                                </select>
                            </label>
                            <label><a class="btn-lit btn-middle" id="search" style="margin-bottom: 3px;" href="javascript:search()"><span>搜索</span></a></label>
                            <label><a class="btn-lit btn-middle" id="searchAll" href="javascript:searchAll();"
                                      style="margin-bottom: 3px;"><span>显示全部</span></a></label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="blank10">
        </div>
        <div class="block">
            <div class="h">
                <span class="icon-sprite icon-list"></span>
                <h3 style="float: left; width: 180px;">商品管理 </h3>

                <div class="bar">
                    <a class="btn-lit aucontrol" href="javascript:addGood();">
                        <span>新增商品</span></a>
                </div>
            </div>
            <div class="tl corner">
            </div>
            <div class="tr corner">
            </div>
            <div class="bl corner">
            </div>
            <div class="br corner">
            </div>
            <div class="cnt-wp">
                <div class="cnt">
                    <table class="data-table even1" width="100%" border="0" cellspacing="0" cellpadding="0">
                        <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">名称
                            </th>
                            <th scope="col">品牌
                            </th>
                            <th scope="col">商品编号
                            </th>
                            <th scope="col">成本价
                            </th>
                            <th scope="col">销售价
                            </th>
                            <th scope="col">平台销售价
                            </th>
                            <th scope="col">库存量
                            </th>
                            <!--<th scope="col">佣金比例-->
                            <!--</th>-->
                            <th scope="col">店铺分类
                            </th>
                            <th scope="col">商品类目
                            </th>
                            <th scope="col">状态
                            </th>
                            <th scope="col">上架状态
                            </th>
                            <th scope="col">备注
                            </th>
                            <th scope="col">更新时间
                            </th>
                            <th scope="col">操作
                            </th>
                        </tr>
                        </thead>
                        <tbody th:remove="all-but-first">
                        <!--/*-->
                        <!--@thymesVar id="goodsList" type="java.util.List<com.huotu.shopo2o.service.entity.good.HbmSupplierGoods>"-->
                        <!--*/-->
                        <tr th:each="goods:${goodsList}">
                            <td class=" txt40 c" style="width: 15px;" th:text="${goodsStat.count}">
                                1
                            </td>
                            <td class="txt80 c" th:text="${goods.name}">
                                商品1
                            </td>
                            <td class="txt80 c" th:text="${goods.brand== null}?'':${goods.brand.brandName}">
                                --
                            </td>
                            <td class="txt80 c" th:text="${goods.bn}">

                            </td>
                            <td class="txt40 c" th:text="'￥'+${goods.cost}">
                                ￥100
                            </td>
                            <td class="txt40 c" th:text="'￥'+${goods.price}">
                                ￥0
                            </td>
                            <td class="txt40 c" th:text="${goods.customerPrice}!=null ? '￥'+${goods.customerPrice} : ''">
                                ￥0
                            </td>
                            <td class="txt40 c" th:text="${goods.usableStore}">
                                600
                            </td>
                            <!--<td class="txt40 c" th:text="${goods.price==0}?'0.00%':(${#numbers.formatDecimal((goods.price - goods.cost)*100/goods.price,1,2)} + '%')">
                                50.00%
                            </td>-->
                            <td class="txt40 c" th:style="${goods.shopCat} == null ? 'color:#ccc;'" th:text="${goods.shopCat}!=null?${goods.shopCat.catName}:'未分类'">
                                分类1
                            </td>
                            <td class="txt40 c" th:text="${goods.type}!=null?${goods.type.name}:''">
                                分类1
                            </td>
                            <td class="txt40 c">
                                <span style="color:red;" th:text="${goods.status.getValue()}">未提交</span>
                            </td>
                            <td class="txt40 c">
                                <span style="color:green;" th:text="${goods.marketable?'上架':'未上架'}">未上架</span>
                            </td>
                            <td class="txt80 c" th:text="${goods.remark}">
                                分类1
                            </td>
                            <td class="txt80 c" hot:date="${goods.lastModify}">
                                --
                            </td>
                            <td class="txt80 c tail">
                                <div style='cursor: pointer'>
                                    <a th:if="${goods.editable()}" th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="goodsEditDeal(this)"> 编辑 </a>
                                    <a th:if="${goods.editable()!=true}" th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="javascript:goodsEditDeal(this)"> 查看详细 </a>
                                    <!--<a th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="javascript:goodsPreviewDeal(this)"> 预览 </a>-->
                                    <a th:if="${goods.editable()}" th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="javascript:updateGoodStatus(this,1)"> | 提交审核 </a>
                                    <a th:if="${goods.operable()}" th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="javascript:updateGoodStatus(this,4);" > | 回收 </a>
                                    <a th:if="${goods.editable()}" th:attr="goodsId=${goods.supplierGoodsId}"
                                       onclick="javascript:removeGood(this)"> | 删除 </a>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!--分页开始-->
                <script type="text/javascript" th:inline="javascript">
                    /*<![CDATA[*/
                    var pageSize = /*[[${pageSize}]]*/ '0';
                    var pageIndex = /*[[*{pageNo}]]*/ '1';
                    var pageCount = /*[[${totalPages}]]*/ '1';
                    var recordCount = /*[[${totalRecords}]]*/ '0';
                    var formName = 'form1';
                    //                                    var pageNoStr = 'pageNoStr';
                    Pager.Output(formName, 'pageNo', pageSize, pageIndex, pageCount, recordCount);
                    /*]]>*/
                </script>
                <!--分页结束-->
            </div>
        </div>
    </div>
</form>
<!--审核对话框start-->
<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable" tabindex="-1" role="dialog"
     aria-labelledby="ui-dialog-title-managerInfoDialog"
     style="display: none; z-index: 1014; outline: 0px; height: auto; width: auto; top: 180px; left: 379.5px;">
    <div id="goodsCheckAndRecycleDialog" style="width: auto; min-height: 49px; height: auto;"
         class="ui-dialog-content ui-widget-content" scrolltop="0" scrollleft="0">
        <div class="hua_card">
            <div style="width:300px">
                <ul>
                    <li id="comment">
                        <label>
                            备注<textarea  name="checkAndRecycleComment" id="checkAndRecycleComment"  style="width: 80%;height: 200%"></textarea>
                        </label>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
        <div class="ui-dialog-buttonset">
            <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"
                    role="button" aria-disabled="false"><span class="ui-button-text">确定</span></button>
            <button type="button"
                    class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-focus"
                    role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button>
        </div>
    </div>
</div>

<div id='bg' style="display:none;"></div>
<div id="loading" style="display:none;">
    <!--手机-->
    <div class="fgk_right" style="width: 350px; position: absolute; top: 18px; z-index: 9999;">
        <div class="fgk_screll" style="display: block;">
            <iframe id="myiframe" height="450" marginheight="0" frameborder="0" width="350px" style="overflow:hidden;" marginwidth="0"></iframe>
        </div>
    </div>
    <img th:src="@{/resources/images/close.gif}" title="关闭窗口" style="position: absolute; cursor: pointer; top: 18px; left: 358px; z-index: 99999999;" onclick ="javascript:closePreviewDeal()"/>
    <!--手机over-->
</div>


<!--审核对话框end-->
<script th:inline="javascript">
    /*<![CDATA[*/
    var totalPages = /*[[${totalPages}]]*/ 1;
    var currentPage = parseInt($("#pageNo").val());
    //查询
    function search() {
        if( $('#brandIdSelect option:selected') )
            $("#brandId").val($('#brandIdSelect option:selected') .val());
        else
            $("#brandId").val(0);
        $("#standardTypeId").val((stId=='0')?"":stId);
        $("input[name=pageNo]").val(1);
        $("#form1").submit();

    }
    function searchAll() {
        window.location.href = goodUrl + "/showGoodsList";
    }

    //商品编辑跳转
    function goodsEditDeal(obj) {
        var goodsId = $(obj).attr("goodsId");
        window.location.href=goodUrl + "/editGood?supplierGoodId="+goodsId;
    }

    //显示商品状态修改对话框
    function updateGoodStatus(obj,status){
        var goodsId = parseInt($(obj).attr("goodsId"));
        var title = "";
        switch(status){
            case 1:
                title="提交审核";
                break;
            case 4:
                title="商品回收";
                break;
        }
        J.ShowDialog("goodsCheckAndRecycleDialog", title, function () {
            var comment = $("#checkAndRecycleComment").val().trim();
            if(status ==4 && comment.length == 0){
                $.jBox.tip("请输入回收原因");
                return ;
            }
            $.jBox.tip("提交中...", "loading");
            $.ajax({
                type:"POST",
                url: goodUrl + "/updateGoodStatus",
                data:{
                    goodsId:goodsId,
                    comment:comment,
                    status:status
                },
                dataType:"json",
                success:function(result) {
                    if (result.code == 200) {
                        $.jBox.tip(result.msg,'success');
                        setTimeout(function () {
                            window.location.reload();
                        }, 500);
                    } else {
                        $.jBox.tip(result.msg,'error');
                    }
                },
                error:function() {
                    $.jBox.tip("发生错误", "error");
                }
            });
        }, function () {
            $(this).dialog('close');
        });
    }

    //删除商品
    function removeGood(obj){
        var goodsId = parseInt($(obj).attr("goodsId"));
        $.jBox.confirm('确定要删除商品吗?','提示',function(v){
            if(v=='ok'){
                $.jBox.tip("删除中...", "loading");
                $.ajax({
                    type:"POST",
                    url:goodUrl + "/deleteGood",
                    data:{
                        goodsId:goodsId
                    },
                    dataType:"json",
                    success:function(result) {
                        if (result.code == 200) {
                            window.location.reload();
                        } else {
                            $.jBox.tip(result.msg,'error');
                        }
                    },
                    error:function() {
                        $.jBox.tip("发生错误", "error");
                    }
                });
            }
        })
    }


    //商品预览
    function goodsPreviewDeal(obj){
        var goodsId = $(obj).attr("goodsId");
        var url = goodUrl + '/showGoodsPreview?goodsId=' + goodsId + '&rnd=' + Math.random();
        $("#myiframe").attr("src",url);
        $("#loading").show();
        $("#bg").show();
    }

    //关闭商品预览
    function closePreviewDeal(obj){
        $("#loading").hide();
        $("#bg").hide();
    }
    /*]]>*/
</script>
</body>
</html>